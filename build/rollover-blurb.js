define(["jquery","meld","extplug/Plugin","plug-modules!plug/views/users/userRolloverView","plug-modules!plug/actions/users/UserFindAction","plug-modules!plug/util/util","extplug/util/request"],function(e,t,r,u,o,n,s){return function(e){function t(u){if(r[u])return r[u].exports;var o=r[u]={exports:{},id:u,loaded:!1};return e[u].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){var u,o;u=[e,t,r(1),r(2),r(3),r(4),r(5),r(9)],o=function(e,t,r,u,o,n,s,l){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(r),d=i(o),p=i(n),f=i(s),c=i(l),h=(0,a["default"])("<span />").addClass("emoji-glow").append((0,a["default"])("<span />").addClass("emoji emoji-1f4dd")),b=Symbol("currently loading blurb"),v=d["default"].extend({name:"Rollover Blurb",description:'Show user "Blurb" / bio in rollover popups.',style:c["default"],enable:function(){this.showAdvice=(0,u.after)(p["default"],"showModal",this.addBlurb),this.hideAdvice=(0,u.before)(p["default"],"hide",this.removeBlurb)},disable:function(){this.showAdvice.remove(),this.hideAdvice.remove()},addBlurb:function(){var e=this;if(this[b]!==this.user){this.$(".extplug-blurb-wrap").remove();var t=(0,a["default"])("<span />").addClass("extplug-blurb"),r=(0,a["default"])("<div />").addClass("info extplug-blurb-wrap").append(t);this[b]=this.user,(0,f["default"])(this.user).then(function(u){if(u&&e[b]===e.user){e[b]=null,e.$(".actions").before(r),t.append(h," "+u);var o=t[0].offsetHeight+6;r.height(o),e.$el.css("top",parseInt(e.$el.css("top"),10)-o+"px"),e.$el.hasClass("chat")&&!e.$el.hasClass("upwards")?e.$el.find(".arrow-down").css("margin-top",o+"px"):e.$el.find(".arrow-down").css("margin-top",0)}})}},removeBlurb:function(){this.$(".extplug-blurb-wrap").remove()}});t["default"]=v,e.exports=t["default"]}.apply(t,u),!(void 0!==o&&(e.exports=o))},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=u},function(e,t,r){var u,o;u=[e,t,r(1),r(6),r(7),r(8)],o=function(e,t,r,u,o,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function l(e){return a["default"].Deferred(function(t){return e.has("blurb")?t.resolve(e.get("blurb")):e.get("level")<5?t.reject(new Error("User does not have a profile page")):e.has("slug")?i(e).then(t.resolve,t.reject):void new d["default"](e.get("id")).on("success",function(r){e.set(r),e.has("blurb")?t.resolve(e.get("blurb")):e.has("slug")?i(e).then(t.resolve,t.reject):t.reject(new Error("Could not find this user's profile URL"))}).on("error",t.reject)})}function i(e){return(0,f["default"])("https://plug.dj/@/"+encodeURIComponent(e.get("slug"))).then(function(e){return e.match(c)[1]}).then(function(t){return e.set("blurb",p["default"].cleanTypedString(t)).get("blurb")})}Object.defineProperty(t,"__esModule",{value:!0});var a=s(r),d=s(u),p=s(o),f=s(n),c=/"blurb">\s*<div class="arrow-up"><\/div>\s*<div class="box">(.*?)<\/div>/;t["default"]=l,e.exports=t["default"]}.apply(t,u),!(void 0!==o&&(e.exports=o))},function(e,t){e.exports=o},function(e,t){e.exports=n},function(e,t){e.exports=s},function(e,t,r){t=e.exports=r(10)(),t.push([e.id,".extplug-blurb{padding:10px;position:absolute;top:3px;background:#282c35;width:100%;box-sizing:border-box;display:none}.expand .extplug-blurb{display:block}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var r=this[t];r[2]?e.push("@media "+r[2]+"{"+r[1]+"}"):e.push(r[1])}return e.join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var u={},o=0;o<this.length;o++){var n=this[o][0];"number"==typeof n&&(u[n]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&u[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),e.push(s))}},e}}])});